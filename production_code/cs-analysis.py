import numpy as np
import pandas as pd
import re


input_list=['prince', 'prince kushner', 'mississippi mean', 'conor mcgregor', 'looks', 'possessions', 'noah', 'joanna', 'joanna jedrzejczyk', '2day', 'junior', 'matt brown', 'awesome', 'juno mission', 'hocaust centers', '000 bm', '000 americans', '18-2', 'government', 'payday', 'fbi', "fbi hillary's andrew mccabe", 'fbi got fisa warrant', "fbi hrc's andrew mccabe", 'fbi granted fisa warrant', 'fbi fisa', 'joke', 'best', 'best eurovision', 'pantera', 'nyc', 'ready', "haim's snl", 'm5', 'spec', 'south africa', 'brad pitt', 'ruth', 'obamagate', 'mothers', 'numb', 'numb by linkin park', 'croatia', 'superbowl', 'evidence', 'wango tango', 'gopher', 'louis', 'joe', 'joe silva', 'joe jonas', '45ers', 'pbo', 'bath', 'hispanics', '1 trillion medicaid', 'enforcer', 'bogus', 'dt', 'manafort', 'answers', 'irish', '217-213', 'marcusrfrancis on instagram', 'united', 'united states', 'united states foreign intelligence surveillance court', 'united states of west america', 'united states of east america', 'united kingdom', 'united airlines', 'vladimir caddie', "let's go crazy", 'bleeding hearts', 'celebrate diversity', 'meia', 'deplorable', 'islamic', 'future speaker', 'flynn', 'roar', 'agent 47 of ufc', '2 usa legally', '2 russia', '2 dems', 'bjj', 'bjj by maia', 'er', 'chechnya', 'krzysztof jotko', 'congress', 'legal fisa', 'woodley', 'asha', 'tb', 'tj', 'voice', 'svoboda', 'heaven', 'wales', 'twood', 'news of fisa warrant', 'one', 'zionist', 'dating white people', '24m', 'eurovision', 'eurovision song contest', 'eurovision shut', 'eurovision 2017', 'guilt', 'russia', "destiny's child", 'amar pelos dois', 'obamacare', 'obamacare repeal vote', 'obamacare deplorable', 'reverse racism', 'michelle', 'norway', 'bad', 'bad things', 'hrc', 'comey', 'donald', 'donald trump', 'donald trump russia', 'centrist', 'putin', 'putin puppet show', 'cbo', 'gitmo', 'nsa', 'eddie', 'eddie alvarez', 'yt13 add42497', 'thetvking', 'kellyanne', 'hooters lone tree', 'sia', 'right', 'rose garden', 'iq', 'arc responds', 'party', 'poland', 'may 13th', 'may 13th: niall', 'jacare souza', 'wnyers', 'jurassic world trailer', 'using siri', 'assholes great', 'asshole yellow belly', 'barry', 'luisa', "o'reilly", 'two', 'administration', 'ptsd', 'twilight', 'katy perry performing', 'amor', 'stubhub center', 'colonialism', 'genius', 'interim 135', 'move with the groove', 'less coverage', 'nothing2 b', 'dark', 'dark horse', 'nate marquardted', "trump-doesn't-care", 'machine gun kelly', 'brit', 'shameful suicide pact', '1st', 'b.j.penn', 'dolly parton', 'grand favourite', 'grand ole putin party', 'sad', 'kells', 'real', 'real madrid', 'brazilians', 'wait carter page', 'western', 'western cape', 'greg leppert', 'brazilian', 'nov 2018', 'd.o.a', 'ukranian', 'together', 'payno', 'vip', 'vip pass', 'hof', 'bc', 'gignac', 'aca', 'tyron woodley', 'mich stepping stones daily', 'breitbarters', 'greet', 'leverage', 'name', 'magat', 'andy biggs', 'rio', 'lot', 'congressional house', 'congressional gopers', 'russias', 'whittaker', 'white', 'white house', 'white supremacists', 'white people', 'white power', 'hallelujah gen. flynn', 'intel', 'imagine kickboxing maia', 'read', 'replace', 'wee bum', 'killed', 'kwazulu', 'whatcha', 'time', 'italian', 'french', 'solar system', 'impeachment', 'mma', 'mma tycoon', 'gigi hadid', 'job', 'meet', 'muslim', 'muslim in america', 'phd', 'msm', 'hallmark', 'trump-putin collusion ship', 'arn anderson', 'mt', 'damaged rodriguez', 'learn', 'last', 'last 3', 'last summer on carter page', 'christian', 'ne', 'mother russia', 'nonsense karaoke', 'probable', '27th', 'tang', 'gave orders', 'obama', 'obama admin', 'obama team', 'obama ck', 'fisa', 'fisa court', 'fisa warrant', 'affirmative action', 'beautiful prince', 'j.j. watt', 'dm', 'odessa', 'goat', 'goat quote', 'ruslana', 'goper', 'carpet', 'latest', 'friendship', 'see', "spicer's hitler", 'sc', 'kayla', 'ignant', 'arizona', 'sean spicer', 'sean spicer on hitler', 'sean spicer carter page', 'bill nye', 'bill clinton', 'winning', "102.7 kiis fm's wango tango", '102.7 kiis fm', 'whites', 'tom clancy', 'israel', 'rep', 'rep schiff', 'chase sherman', 'sam', 'sam clovis', 'pagie', 'seeing alvarez', 'octagon', 'god', 'god rodriguez', 'sheila jackson', 'carrot', 'carter', 'carter page', 'carter page 2016', 'carter page by fbi', 'carter page washington post the fbi', 'carter page get', 'carter page fisa', 'carter page in 2016', 'carter page to russia with love', 'carter page the washington post', 'carter page.fisa', 'carter page.y', 'malibu', 'george', 'george soros', 'feet king size normal', 'democratic', 'democratic party', 'pay the pricehouse republicans', 'the house republicans', 'the answer', 'the sleep-inducing backpack', 'the human cellophane', 'stop', 'stop drinking the left', 'stop playing', 'liam', 'liam payne', 'hillary', 'hillary clinton', 'ron', 'coloradans', 'medicaid 4', 'winner of salvador sobral', 'moscow', 'chris hayes', 'chris pratt', 'hero', 'adele', 'knew', 'sims city', 'next', 'hate', 'hate white people', 'muslims', 'alone', 'fake christians', 'gareth bale', 'fan poll', 'listening', 'u.s', 'female genital mutilation', 'project ara', 'islam', 'netanyahu', 'britain', 'jorge', 'jorge masvidal', 'eleventeen', 'goodbye', 'seriously', 'richie', 'robbed', 'photos of katy', 'str8 g', 'convene the death panel', 'instagram', 'instagram story', '2015 outfit', '2015 modular phone', 'usa', 'chameleon loves', 'doa', 'maryland', 'australian', 'edgar', 'edgar by tko', 'edgar holloway', 'jews', 'sunshine', 'murderous boss', 'conversation page', 'womd', 'fitch', 'hpn', 'eric allen bell', 'disappointed with ca', 'moldova', 'cyprus', 'crazy', 'crazy raccoon gosha loves washing', 'dnc', 'tv', 'tv ufc 211 live stream edgar', '3-0', 'linkinpark', 'goes 2', '😢are', 'americans', 'americans on twitter', 'buzina', 'fotn', 'zero', 'jessica andrade', 'traitor trump', 'authoritarian kleptocracy', 'ann courter', 'town', 'wrestlemania', 'p3ople', 'tease', 'senators', '216th', 'scottish', 'marketwatch', 'tinker taylor soldier spicoli', 'house', 'house democrats wave', 'house passes bill', 'house of representatives', 'house republicans', 'house passage', 'jeff sessions', 'copy', 'gamebred', 'confirming fisa', 'con', 'middle east', '60s', 'tango', 'swedens', 'sports', 'martin luther king', 'martin luther king jr', "google's project tango", 'ppv', 'russians', 'jason blossom', 'jason knight', 'jason chaffetz', 'american', 'american christians', 'american health system', 'american health care act', '40s', 'jolene', '2nd', '4am', 'susan rice', "ko'd", 'funny puppy drinking milk', 'snub house bill', 'gif', 'korean peninsula', 'starving', 'scared', 'scared to be lonely', 'goddess', 'sad+bad', 'tell', 'opposition rally', 'reconstruction south', 'uk', 'vote', 'july', 'july 28', 'mcgregor', 'russia-linked trump', 'hr', 'moc', 'nkorea', 'tko', 'poc', 'look', 'look full photo', 'switzerland', 'sheeple', 'trump', 'trump coffins', 'trump tower', 'trump loved carter page', 'good lord', 'bosnia', 'folks', 'clinton', '2017 song', '2017 grand final', 'masvidal', 'masvidal on the sherdog forums', 'masvidal ko', 'masvidal by tko', 'bbc news', 'bsb', 'shows', '26th', 'slow hands', 'ces las vegas', 'ces 2016', 'foreign agent of the russians', 'arse-bearer', 'clintons', 'twitter', 'bucks fizz', 'lgbt', 'alessia', 'alessia cara', 'representatives', 'north america', 'north cork', 'trumpcare', 'republican', 'republican obamacare', 'republican party', 'republican fbi director comey refused', 'potus', 'bitch wbzg thenesjdjdnx', 'whole eye closed', 'guy', 'care', 'aaron', 'jenga', 'proof', 'frankie', 'frankie edgar', 'vlad putin', 'stipe', "poland's 2014", 'free', 'free wango tango', 'free unfollow unfollowers', 'rep—but', 'lives', 'tude', 'camila', 'camila cabello', 'london', 'family services', 'moro', 'finally a special prosecutor', 'true equality', 'got', 'got barfy cam', 'bruce buffer', 'watch', 'watch ufc 211', 'left', 'bush', 'complaint', 'chester', 'chester bennington', 'lincoln', 'simpsons', 'comrade comey', 'enter ground', 'ukrainian', 'i want candy', 'donors', 'flint', 'bon appétit', 'bon appetit', 'tip of the iceberg', 'it aint my fault', 'nc', 'lovely owls', 'hq', 'hell-bows', 'session', 'dmoceanu', 'brilliant', 'brilliant recreation', 'repeal', 'dave matthews', 'albert einstein', 'demianmaia', 'ic', 'netherlands', 'getting', 'spineless mayonnaise turds celebrate victory', 'sophie turner', 'guys', 'mmafightingedgar 10-9', 'soviet russia', 'rotherham', 'performing', 'performing the song with liam', 'gop', 'gop house', 'gop republicans', 'acting atty general', 'district', 'don', 'don the con', 'google', 'australians', 'rosneft', 'african americans', 'african american', 'hailee steinfeld', 'sleepy lion cubs', 'rme', 'martian', 'cheetolini', 'antisemitism', 'spring', 'petra', 'russia-trump', 'dance', 'making', 'republicans', 'standing', 'spicer', 'barack obama', 'germany', 'roger pontare', 'democrat', 'democrat party', 'ireland', 'books', 'lp song', 'holloway', 'greatness back', 'diane abbott', 'sounders', '2000s linkin park', 'tweets', 'lee lin', 'panthers', 'ohio', 'keitholbermann', "california's house republicans", 'miah', 'go', 'progressives', 'slovenia', 'native americans', 'loose', 'malignant republican', 'genocide in middle east', 'wrong', 'summon electricity', 'holy', 'holy father', 'asians', 'election day', 'ca', 'euro', 'parabéns', 'arya stark', 'king 2', 'thehill', 'steele the savior', 'racism', 'stella', 'himmel och hav', 'whitehouse', 'blair', 'msnbc', 'disney', 'type 1', '200k', 'otc', 'acha', 'scary clown cars', 'european', 'coulter', 'niam', 'asian', 'canelo', 'late flight back', '10-8', 'personal bankruptcy', 'hybrid theory', 'spicy', '8yr bc', 'post fight interview', 'wapo', 'wapo carter page', 'mpumalanga', 'on the loose', 'royce 2.0', 'carlos condit', 'liberals', 'rick story', 'russian', 'russian agent', 'oaklettes learn', 'poles', 'big', 'big homie stipe', 'le pen', "o'care", 'salvador', 'salvador sobral', 'va', 'become law', 'warriors', 'ct', 'moto x4', 'happy', 'happy birthday', 'violet', 'eerie linkin park', 'tokio hotel', 'breitbart', 'people', 'lenovo', 'single', 'single country', 'single day', 'nialler', 'dem', 'dem sorosian', 'us', 'us senate', 'humor', 'libnazi', 'america', 'america great', 'icymi', 'linkin', 'linkin narc', 'linkin park', 'canadian', 'amanda', 'joe-jitsu', 'kyiv', 'since', 'since the 90-day', 'fourth reich', 'crush', 'treason', 'general office', 'proud', 'adam', "adam levine's new girlfriend", 'red', 'red people', 'red carpet', 'kittens', 'ahca', '2monitor trump', 'vets', 'cute miley', 'english', 'hilary', 'trumped', 'monitor fmr', 'monitor carter page', 'rodriguez', 'rodriguez get', 'rodriguez tbh edgar fighted brilliant', 'kool-aid', 'mussolini', 'privilege', 'brexit', 'doj', "portugal's 1992", 'sbs', 'sjw', 'soon', 'yeezy yeezy', 'ufc', 'ufc hall of fame', 'ufc 211', 'ufc 211 live stream edgar', 'ufc light heavyweight champion daniel cormier', 'judy', '2-boot', 'classic', 'earth', 'acid attacks', 'constitution', 'hurry', 'wannabe diaz', 'eyes closed', 'moon', 'liberty university', 'currently', 'profit', '20-17', 'stomp-on-history', 'russia--why', 'europeans', 'administrati', 'gauteng', 'millions of americans', 'miley', 'link', 'harry', 'take', 'take the red pill', '25th', '2-party msm', 'u.k', '2013 feels', 'lucie jones', 'gamebredfighter', 'dead', 'kay', 'senate', 'senate gop', 'senate in 2018', 'senate on obamacare', 'gopers', 'world news', 'world news update] fbi', 'world trends', 'village', 'village of the damned', 'cowboys', 'liberal', 'ts maia', 'gone', 'beast', 'investigate the fbi director', 'nunes', 'team pop', 'syria', 'migos', 'washington post', 'washington post fbi', 'e.t', 'counter-terrorism', 'dr.king', 'joevin jones', 'actually', 'actually australia', 'jj', '90-day', 'blue', 'prison rules', 'niall', 'niall horan', 'niall 【fr', 'rice', 'lord vader', 'wv', 'horrible health bill', 'horrible care act', 'racist', '37.7t', 'sowell', 'romania', 'think carter page', 'damian maia', '7 irish', 'firework', 'ohioans', 'holocaust', 'holocaust centers', 'darrell issa', 'pa', 'wash post', 'vitalii sediuk', 'fundraising', 'josh', 'mcdonald', 'explain', 'kill children', 'fool-aid', 'cnn', 'cnn house republicans', 'daniel cormier', 'hair plug procedures', 'oath', 'sweden', 'dos santos', 'nina', 'david', 'david branch', 'falling', 'dope', 'hold', 'hold tight', 'lose', '5-round', 'australia', 'new', 'new health hashtag', 'texas', 'california', 'nunez', 'dump', 'flight back', 'messenger', 'june', 'justice', 'justice department', 'voted', 'bloods', 'heavyweight champ', 'better', 'recess', 'deal', 'wonder', 'wonder world tour', 'europe', 'exploded', 'snapchat', 'assist', '600k rep', 'ryan gosling in la la land', 'puppet master', 'linking park', 'portugal', 'spurs', 'congressmen', 'zedd', 'mary', 'maroon 5', 'this town', 'fox news', 'double bed nylon mosquito net', '80s', 'dustin poirier', 'lbj', 'bryce harper', 'max', 'ouch', 'un secgen', 'mccanns', 'buzzfeed germany', 'sen', 'judge', 'october', 'october 28', 'rhythm', 'dana', 'trumps', 'florida', 'fun fact', 'officer william stacy', 'devil', 'sweeter', 'payne', 'wh', 'page', "eurovision's opening ceremony", 'comney', 'internet', 'mlk', 'mlk jr', 'mexican', 'latino', 'remember the dreamworks', 'pop bubbles', 'far', 'stupid', 'somewhere a sjw', 'jesus christ', 'dogs annoying cats', 'striking', 'thatcher', 'paul ryan', 'paul manafort', 'fire', 'dems', 'frankieedgar', 'carson', 'stay', 'champion', 'sounds', 'maia', 'maia with the linkin park', 'paid higher premiums', 'libs', 'superior spa', 'san bernardino', 'san diego', 'wade', 'pocs', 'wot', 'auntie', 'chipmunk stretches in the morning', 'jd', 'numbers 116-131', 'round 2', 'måns', 'die', 'healthcare', 'spaniard', 'really', 'iraq war', 'mou', 'lynch', 'avril', 'avril lavigne', 'irs', 'need', '15pm pst', 'love', 'love masvidal', 'love myself', 'administrator required in nelspruit [read', 'warrant on carter page', 'gameb', "britain's lucie jones", 'shit', 'nice', 'nice trump', 'imri', 'vienna', 'office space', 'netflix canceled', 'welterweight', 'rewrite obamacare', 'spain', 'report', 'boom', 'mercedes f015 concept car drives', 'luhan', 'kiev', 'come on damien maia', 'strip', 'anna wintour', 'titanium', 'titanium by david guetta', 'tillerson', 'matchmaker joe silva', 'four', 'n. europeans', 'rich', 'bradford', 'anglo celtic australian', '64 crow', 'retweeted the new york times', 'jimmy fallon sing', 'get', 'get help', 'get married', 'michelob lites', 'military', 'slayed', 'political suicide', 'anti-white bots trying', 'christianity', '🚫h8', 'vs reality —happy moth', 'ceo of russia oil', 'aussies', 'mendes', 'jackson wink', 'press conference', 'arab', 'eminem', '10-9s', 'jacked', 'baby elephant bathing', 'dear white people', 'first', 'first time', 'ivanka', 'reps', 'planned parenthood', 'wikipedia', 'iolo', 'civil war', 'civil rights laws', 'weiner', 'imperialism', 'finnish', 'slavery', 'flaca', 'theresa may', 'oil deals with russia', 'passed a bill', 'live on the yellow carpet', 'loyal gop', 'brand new moves', 'democrats', 'wcs', 'victory', 'died', 'force', 'michael savage', 'clumsy baby elephant', 'el joven diario', 'jones', 'cuter', 'mean the fbi', '3rd', '9th', '3-car', 'answer', 'chained', 'natal', 'turkey', 'nazi', 'cankles', 'demian', 'demian maia', 'aldo-holloway', 'hope maia', 'sing', 'hansel robles', 'darth vader', 'top social artist award army', 'top spanish', 'top news', 'devin nunes', 'understanding the carter page', '32-11', 'aussie', 'mike', 'mike dean liberty university stoke', 'mike flynn', 'mike vick', 'arriba', 'gano', 'german', 'gamebread 3', 'announcing', 'rae lewis-thornton daily', 'africa', 'campaign manager manaford', 'black', 'black people', 'black guy dies first', 'macron', 'céline dion', 'higher deductible', 'f**k', 'special education', 'dc', 'write', 'almost', 'cormier', 'euros', 'govt', 'leaving malta', 'los angeles releases the lineup', '100-150', 'infidels', 'yair', 'yair rodriquez', 'yair rodríguez', 'yair rodriguez', 'yair rodriguez full fight', 'great', 'cc1', 'buy', 'buy $bvtk', 'besides carter page', 'countries', 'excited', 'dow', 'rashad coulter', 'ronaldo', 'crips', 'daddy [de zayn', 'champions', 'rd 1', 'rd 2', 'british isles', 'foot-in-mouth', 'we cant stop', 'zayn', 'lower', '4 uber', 'co', '24 gop', '24 house republicans', 'mexico', 'ny', 'blacks', 'power corrupts', '4th', 'teenage dream', 'africans', 'hey hey goodbye', 'dq', 'woke', 'pastor jerry', 'swedish', 'azerbaijan', 'lisbon', 'hitler', 'watching edgar', 'bulgarian', 'words', 'michigan', 'asshats', 'dad', 'jam', 'scarface', 'scarface theme', 'panic', 'back', 'age', 'raw story', 'greece', 'business', 'bulgaria', 'jamala', 'james bond', 'james comey', 'djt', "trump's foreign policy advisor", 'freedom', 'affordable care act drove', 'rus', 'christians', 'sessions', 'sessions page', 'alex caceres', 'boa constrictor', "hillary's andrew mccabe", 'aldo', 'surprise', 'rokita', 'pics of miley', 'makes', '30k', '4th-story', 'ukraine', 'sunny in philadelphia']
tweets_unpartitoned=pd.read_csv("tweets_3k_annotated.csv",sep =',')
annotated_candidate_list=[]
annoated_mention_list=[]
ritter_list=[]

our_counter=0
our_recovered_counter=0
our_counter_mention=0
our_recovered_mention=0
# input_df= pd.DataFrame(columns=('tweetID', 'sentID', 'hashtags', 'user', 'TweetSentence', 'phase1Candidates','start_time','entry_batch'))
for index,row in tweets_unpartitoned.iterrows():
	annotated_candidates=str(row['mentions_other'])
	tweet_level_candidate_list=annotated_candidates.split(';')
	for sentence_level_cand_list in tweet_level_candidate_list:
		sentence_level_cand= sentence_level_cand_list.split(',')
		for cand in sentence_level_cand:
			if((cand!='')&(cand!='nan')):
				# print(cand.strip())
				cand_to_put=cand.lower().strip()
				annoated_mention_list.append(cand_to_put)
				if(cand_to_put not in input_list):
						our_counter_mention+=1
				else:
					our_recovered_mention+=1
				if (cand_to_put not in annotated_candidate_list):
					annotated_candidate_list.append(cand_to_put)
					if(cand_to_put not in input_list):
						our_counter+=1
					else:
						our_recovered_counter+=1
					# print(cand_to_put, '==>',row['TweetText'])

	ritter_candidate_list=str(row['ritter_candidates']).split(',')
	for candidate in ritter_candidate_list:
		if((candidate!='')&(candidate!='nan')):
			ritter_cand=candidate.lower().strip()
			if ritter_cand not in ritter_list:
				ritter_list.append(ritter_cand)
# print(annotated_candidate_list)	


input_set=set(input_list)
annotated_candidate_set=set(annotated_candidate_list)

ritter_set=set(ritter_list)

print(len(annotated_candidate_list),len(annotated_candidate_set))
print(len(annotated_candidate_set-input_set),our_counter,our_counter_mention)
print(len(annotated_candidate_set-ritter_set))
print(len(annoated_mention_list),our_counter_mention,our_recovered_mention)
print('our-recovered-counter: ',our_recovered_counter)
cs_missed=annotated_candidate_set-input_set
ritter_missed=annotated_candidate_set-ritter_set
print(len(cs_missed.intersection(ritter_missed)))